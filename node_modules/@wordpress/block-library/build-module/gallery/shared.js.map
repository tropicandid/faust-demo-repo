{"version":3,"sources":["@wordpress/block-library/src/gallery/shared.js"],"names":["get","pick","Platform","defaultColumnsNumber","imageCount","Math","min","pickRelevantMediaFiles","image","sizeSlug","imageProps","url","source_url","fullUrl","getGalleryBlockV2Enabled","window","wp","galleryBlockV2Enabled","isGalleryV2Enabled","isNative","process","env","IS_GUTENBERG_PLUGIN"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,GAAT,EAAcC,IAAd,QAA0B,QAA1B;AAEA;AACA;AACA;;AACA,SAASC,QAAT,QAAyB,oBAAzB;AAEA,OAAO,SAASC,oBAAT,CAA+BC,UAA/B,EAA4C;AAClD,SAAOA,UAAU,GAAGC,IAAI,CAACC,GAAL,CAAU,CAAV,EAAaF,UAAb,CAAH,GAA+B,CAAhD;AACA;AAED,OAAO,MAAMG,sBAAsB,GAAG,UAAEC,KAAF,EAAiC;AAAA,MAAxBC,QAAwB,uEAAb,OAAa;AACtE,QAAMC,UAAU,GAAGT,IAAI,CAAEO,KAAF,EAAS,CAAE,KAAF,EAAS,IAAT,EAAe,MAAf,CAAT,CAAvB;AACAE,EAAAA,UAAU,CAACC,GAAX,GACCX,GAAG,CAAEQ,KAAF,EAAS,CAAE,OAAF,EAAWC,QAAX,EAAqB,KAArB,CAAT,CAAH,IACAT,GAAG,CAAEQ,KAAF,EAAS,CAAE,eAAF,EAAmB,OAAnB,EAA4BC,QAA5B,EAAsC,YAAtC,CAAT,CADH,IAEAD,KAAK,CAACG,GAFN,IAGAH,KAAK,CAACI,UAJP;AAKA,QAAMC,OAAO,GACZb,GAAG,CAAEQ,KAAF,EAAS,CAAE,OAAF,EAAW,MAAX,EAAmB,KAAnB,CAAT,CAAH,IACAR,GAAG,CAAEQ,KAAF,EAAS,CAAE,eAAF,EAAmB,OAAnB,EAA4B,MAA5B,EAAoC,YAApC,CAAT,CAFJ;;AAGA,MAAKK,OAAL,EAAe;AACdH,IAAAA,UAAU,CAACG,OAAX,GAAqBA,OAArB;AACA;;AACD,SAAOH,UAAP;AACA,CAdM;;AAgBP,SAASI,wBAAT,GAAoC;AACnC;AACA;AACA,MAAK,CAAEC,MAAM,CAACC,EAAT,IAAe,OAAOD,MAAM,CAACC,EAAP,CAAUC,qBAAjB,KAA2C,SAA/D,EAA2E;AAC1E,UAAM,gDAAN;AACA;;AACD,SAAOF,MAAM,CAACC,EAAP,CAAUC,qBAAjB;AACA;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,SAASC,kBAAT,GAA8B;AACpC;AACA;AACA;AACA,MAAKhB,QAAQ,CAACiB,QAAd,EAAyB;AACxB,WAAOL,wBAAwB,EAA/B;AACA,GANmC,CAQpC;AACA;;;AACA,MAAKM,OAAO,CAACC,GAAR,CAAYC,mBAAjB,EAAuC;AACtC,WAAOR,wBAAwB,EAA/B;AACA;;AAED,SAAO,IAAP;AACA","sourcesContent":["/**\n * External dependencies\n */\nimport { get, pick } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Platform } from '@wordpress/element';\n\nexport function defaultColumnsNumber( imageCount ) {\n\treturn imageCount ? Math.min( 3, imageCount ) : 3;\n}\n\nexport const pickRelevantMediaFiles = ( image, sizeSlug = 'large' ) => {\n\tconst imageProps = pick( image, [ 'alt', 'id', 'link' ] );\n\timageProps.url =\n\t\tget( image, [ 'sizes', sizeSlug, 'url' ] ) ||\n\t\tget( image, [ 'media_details', 'sizes', sizeSlug, 'source_url' ] ) ||\n\t\timage.url ||\n\t\timage.source_url;\n\tconst fullUrl =\n\t\tget( image, [ 'sizes', 'full', 'url' ] ) ||\n\t\tget( image, [ 'media_details', 'sizes', 'full', 'source_url' ] );\n\tif ( fullUrl ) {\n\t\timageProps.fullUrl = fullUrl;\n\t}\n\treturn imageProps;\n};\n\nfunction getGalleryBlockV2Enabled() {\n\t// We want to fail early here, at least during beta testing phase, to ensure\n\t// there aren't instances where undefined values cause false negatives.\n\tif ( ! window.wp || typeof window.wp.galleryBlockV2Enabled !== 'boolean' ) {\n\t\tthrow 'window.wp.galleryBlockV2Enabled is not defined';\n\t}\n\treturn window.wp.galleryBlockV2Enabled;\n}\n\n/**\n * The new gallery block format is not compatible with the use_BalanceTags option\n * in WP versions <= 5.8 https://core.trac.wordpress.org/ticket/54130. The\n * window.wp.galleryBlockV2Enabled flag is set in lib/compat.php. This method\n * can be removed when minimum supported WP version >=5.9.\n */\nexport function isGalleryV2Enabled() {\n\t// The logic for the native version is located in a different if statement\n\t// due to a lint rule that prohibits a single conditional combining\n\t// `process.env.IS_GUTENBERG_PLUGIN` with a native platform check.\n\tif ( Platform.isNative ) {\n\t\treturn getGalleryBlockV2Enabled();\n\t}\n\n\t// Only run the Gallery version compat check if the plugin is running, otherwise\n\t// assume we are in 5.9 core and enable by default.\n\tif ( process.env.IS_GUTENBERG_PLUGIN ) {\n\t\treturn getGalleryBlockV2Enabled();\n\t}\n\n\treturn true;\n}\n"]}